# GTFS フィードを一般公開する

## GTFS を共有するメリット

GTFS データはさまざまな方法で利用できます。交通事業者の GTFS データを一般公開すると、乗客と交通事業者全体に多くのメリットがもたらされます。メリットには次のものが含まれます。

- フィードをモバイルおよびウェブベースの便計画アプリケーションに統合し、乗客がシステムで便を計画できるようにする
- Mobility Database などの GTFS アグリゲータにフィードを送信すると、より多くのユーザーが利用し、事業者の知名度が向上する
- 地理情報システム (GIS) やその他の地図ベースの分析プログラムで GTFS データを視覚化および分析できるツールを使用する

###便計画アプリ

交通事業者の GTFS データが公開されると、Google マップに加えてさまざまな便計画アプリケーションでそのデータを利用できるようになります。これらには、Bing マップ、Apple マップなどの他のナビゲーション アプリや、Transit、Moovit、Transportr、Citymapper などの交通事業者専用プラットフォームが含まれます。さらに、オープン フィード データにアクセスすることで、開発者は特定の地域向けのアプリを作成したり、Vamos (カリフォルニア州サンホアキン郡およびスタニスラウス郡)、MetroHero (ワシントン DC エリア)、Entur (ノルウェー) などの標準の便計画者に含まれていない機能を備えたアプリを作成したりできます。

### フィード アグリゲーター

GTFS データを共有すると、GTFS フィード アグリゲーション プラットフォームによってインデックス付けされることも可能になります。これには、GTFS フィードの州レベルまたは地域レベルのディレクトリや、[Mobility Database](https://database.mobilitydata.org/) や [Transitland](https://www.transit.land/) などの国際的なフィード アグリゲーターが含まれます (その他のフィード アグリゲーターについては、[こちら](../../resources/data) を参照してください)。フィード アグリゲータにインデックス登録されると、事業者の可視性が高まり、開発者、研究者、その他の関係者が、新しいアプリケーションの開発など、さまざまな目的で事業者のデータに簡単にアクセスできるようになります。

### GIS、分析、その他のプラットフォームやツールとの統合

GTFS データは、さまざまな地理空間分析プラットフォームにインポートして使用することもできます。 Esri の ArcGIS などの地理情報システム (GIS) プログラムやオープンソースの QGIS には、GTFS の停留所とルート データをインポートして視覚化できる独自のプラグインと拡張機能があります。

- Esri には、スケジュール データの視覚化など、GTFS データを使用する [さまざまなツールとプラグイン](https://github.com/Esri/public-transit-tools) があります
- QGIS では、[GTFS-GO](https://plugins.qgis.org/plugins/GTFS-GO-master/) と [GTFS Loader](https://plugins.qgis.org/plugins/GTFS_Loader/) を使用して、プラットフォーム内でルート・路線系統+停留所等を視覚化できます 
- [追加の分析ツール](../../resources/agency-tools)

その他のプラットフォームでは、GTFS データを独自の方法で視覚化および分析できます:

- [Conveyal](https://conveyal.com/) は、ユーザーが GTFS データをインポートしてスケジュール、ルート・路線系統、パターンを視覚化し、潜在的なサービス変更の影響を分析できるオープンソース プログラムです。また、ユーザーは人口統計データをインポートして操作し、たとえば、さまざまなルート・路線系統やスケジュールが特定の都市部での職場へのアクセスにどのように影響するかを分析できます。
- [GTFS to HTML](https://gtfstohtml.com/) は、GTFS scheduleデータを HTML 時刻表に変換できるオープンソース ツールです。これにより、交通事業者はスクリーン リーダーでも読み取れる形式でウェブサイトにスケジュールを自動的に公開および更新できるため、視覚障害のある人もデータにアクセスできます。

## データの共有: ヒントとベスト プラクティス

### 永続的な取得リンクを作成して維持する 

取得リンクは、交通事業者のGTFS scheduleファイルが保存される永続的な URL です。通常、フェッチ リンクは交通事業者のウェブサイトでホストされるか、GTFS 制作のためにベンダーと契約している場合はベンダーによってホストされます。これは、Google マップなどの便計画アプリがデータにアクセスする方法です。GTFS scheduleファイルは、ログインを必要とせずにこの URL から直接ダウンロードするべきであるのが理想的です。ただし、ライセンスの制限によりこれが実現できない場合は、事業者がAPI キーを使用してデータのユーザーに発行することで、データへのアクセスを制御できます。

### URL とファイル名

一貫した取得リンクと GTFS ファイル名は、フィード データへのアクセスを保証するために不可欠です。事業者がデータに一貫した URL とファイル名を使用しないと、便計画アプリ、フィード アグリゲータ、およびその他のユーザーが最も正確で最新のデータを取得できず、長期的には問題が発生することになります。

永続的な取得リンクの URL を設定したら、それを変更しないでください。つまり、ファイル自体が更新された場合でも、URL 名は一貫性を保つするべきである。そのため、URL はできる限りシンプルで汎用的なままにして、日付やバージョン番号が含まれる URL は使用しないようにしてください。

-**良い例:** http://www.bart.gov/dev/schedules/google_transit.zip、
-**避けるべき例:** http://www.bart.gov/dev/schedules/google_transit_Fall_2021.zip

同様に、フィード自体を更新した場合でも、 GTFS scheduleファイルを含む ZIP フォルダの名前は一貫しているようにしてください。たとえば、フィードを更新する場合、ZIP フォルダ名にdateやバージョン番号を一切追加しするべきではない。フィード バージョンやフィードの開始日と終了日に関するデータをフィードに含める場合は、`feed_info.txt`ファイルに含めることができます。

- **良い:** 「YourAgency_gtfs.zip」、「google_transit.zip」、「gtfs.zip」、
- **避けるべき:** 「YourAgency_gtfs_092921.zip」、「YourAgency_Fall2021.zip」


### ファイル構成と整合性

Your GTFS は、相互に接続された複数のTextファイル (.txt) を含む zip ファイルです。形式が正しいことを確認するには、常に次の操作を行ってください。

 1.Textファイルを開くときは、値がTextのままであることを確認してください。GTFS には、Excel などのアプリケーションで誤って読み取られたり、省略されたりするフィールドが多数あります。
 2.ファイルはタブ区切りではなく、カンマ区切りです。つまり、各ファイルには行にレコードが含まれ、各フィールドはカンマで区切られています。
 3.余分な行や列があると、使用するアプリケーションでエラーが発生するため、ファイルを保存するときに空の行や列がないことを確認してください。
 4. GTFS 内のファイルを破棄しないでください。ファイルは連携して動作し、不足しているファイルがあると、使用するアプリケーションでエラーが発生するしてもよい。
 5.ファイルを再圧縮するときは、ファイルを含むフォルダではなく、ファイルを圧縮するようにしてください。ファイルを解凍して、ファイルを含む別のフォルダではなく、そのフォルダ内のファイルをすぐに確認できれば、正しく実行されたことを確認できます。


### その他の考慮事項

複数の事業者が異なる名前やコードで同じ停留所を共有している場合、Google マップなどのアプリケーションでは1つを選択する必要がある場合があります。混乱を避けるために、他の事業者と調整して名前とコードについて合意してください。これにより、異なる GTFS データセット間の競合が最小限に抑えられます。

複数の GTFS データセットを利用できる場合 (通常は、1つは Transit App などのパブリック アプリケーション用に作成され、もう1つは社内の運用 CAD/AVL システム用に作成された結果)、公開する GTFS としてどれを使用するかを決定する必要がしてもよい。乗客向けの情報を最も多く含むフィードを宣伝することを推奨。可能な限り、GTFS データセットが一致するように ( 停留所等や便などの ID が同じになるように) してください。そうすることで、社内のデータセットがパブリックのデータセットと競合することがなくなり、GTFS-RT などの他のフィードを統合できるようになります。
