# GTFSフィードを公開する {: #making-your-gtfs-feed-publicly-available}

## GTFS を共有することの利点 {: #benefits-of-sharing-your-gtfs}


GTFS データはさまざまな方法で活用することができ、事業者の GTFS データを公開して共有することで、乗客や事業者全体に多くの利点をもたらします。これには以下が含まれます:

- モバイルやウェブベースの旅程計画アプリケーションにフィードを統合し、乗客がシステム上で旅程を計画できるようにすること
- Mobility Database のような GTFS アグリゲーターにフィードを提出し、より広い利用者層にリーチし、事業者の認知度を高めること
- GTFS データを地理情報システム (GIS) やその他の地図ベースの分析プログラムで可視化・分析できるツールを利用すること

### 旅程計画アプリ {: #trip-planning-apps}

事業者のGTFSデータが公開されると、Google Mapsに加えてさまざまな旅程計画アプリで利用することができます。これには、Bing Maps、Apple Mapsといった他のナビゲーションアプリや、Transit、Moovit、Transportr、Citymapperといった公共交通専用のプラットフォームが含まれます。さらに、オープンフィードデータへのアクセスにより、特定の地域に特化したアプリや、標準的な旅程計画アプリには含まれない機能を持つアプリを開発することも可能になります。例えば、Vamos（カリフォルニア州サンホアキン郡およびスタニスラウス郡）、MetroHero（ワシントンD.C.地域）、Entur（ノルウェー）などがあります。

### フィードアグリゲーター {: #feed-aggregators}

GTFS データを共有することで、GTFS フィード集約プラットフォームにインデックスされることも可能になります。これには、州や地域レベルの GTFS フィードディレクトリ、さらには [Mobility Database](https://database.mobilitydata.org/) や [Transitland](https://www.transit.land/) といった国際的なフィードアグリゲーターが含まれます（その他のフィードアグリゲーターについては[こちら](../../resources/data)をご覧ください）。フィードアグリゲーターにインデックスされることで、事業者の認知度が高まり、開発者、研究者、その他の関心を持つ人々が、アプリケーション開発を含むさまざまな目的で事業者のデータに容易にアクセスできるようになります。

### GIS、分析、その他のプラットフォームやツールとの統合 {: #integration-with-gis-analysis-and-other-platforms-and-tools}

GTFS データは、さまざまな地理空間分析プラットフォームにインポートして利用することもできます。Esri の ArcGIS のような地理情報システム (GIS) プログラムや、オープンソースの QGIS には、GTFS の停留所等(stop)やルート・路線系統(route)データをインポートして可視化できる独自のプラグインや拡張機能があります。

- Esri には、GTFS データを利用する[多様なツールやプラグイン](https://github.com/Esri/public-transit-tools)があり、運行データの可視化も含まれます  
- QGIS では、[GTFS-GO](https://plugins.qgis.org/plugins/GTFS-GO-master/) や [GTFS Loader](https://plugins.qgis.org/plugins/GTFS_Loader/) を利用して、プラットフォーム内でルートや停留所等(stop)を可視化することができます  
- [追加の分析ツール](../../resources/agency-tools)

その他のプラットフォームでは、GTFS データを独自の方法で可視化・分析することができます。

- [Conveyal](https://conveyal.com/) はオープンソースのプログラムで、GTFS データをインポートして運行表、ルート、パターンを可視化し、将来のサービス変更の影響を分析することができます。利用者は人口統計データをインポートして、特定の都市部において異なるルートや運行表が職場へのアクセスにどのような影響を与えるかといった分析を行うこともできます。  
- [GTFS to HTML](https://gtfstohtml.com/) はオープンソースのツールで、GTFS 運行データを HTML の時刻表に変換することができます。これにより、事業者は自社のウェブサイト上で運行表を自動的に公開・更新でき、スクリーンリーダーでも読み取れる形式となるため、視覚障害者にとってもデータが利用可能になります。  

## データ共有: ヒントとベストプラクティス {: #sharing-your-data-tips-best-practices}

### 永続的なフェッチリンクの作成と維持 {: #create-and-maintain-a-permanent-fetch-link}

フェッチリンクとは、事業者の GTFS Schedule ファイルが保存されている永続的な URL のことです。通常、これは事業者のウェブサイト上、または GTFS の作成を委託している場合はベンダーによってホストされます。Google Maps のような経路検索アプリは、この方法でデータにアクセスします。理想的には、GTFS Schedule ファイルはログインを必要とせず、この URL から直接ダウンロードできるようにするべきです。しかし、ライセンス上の制約によりそれが実現できない場合、事業者は API キーを利用者に発行することでデータへのアクセスを制御することができます。

### URL とファイル名 {: #url-and-file-names}

フィードデータへのアクセスを確保するためには、一貫した取得リンク(URL)と GTFS ファイル名が極めて重要です。事業者がデータに対して一貫した URL やファイル名を使用していない場合、経路検索アプリ、フィードアグリゲータ、その他の利用者が最新かつ正確なデータを取得できず、長期的に問題を引き起こすことになります。

一度、恒久的な取得リンクの URL を設定したら、**変更してはいけません**。これは、ファイル自体が更新されても URL 名は一貫して維持されるべきであることを意味します。そのため、URL はできるだけシンプルかつ汎用的にし、日付やバージョン番号を含む URL の使用は避けてください。

- **良い例:** http://www.bart.gov/dev/schedules/google_transit.zip  
- **避けるべき例:** http://www.bart.gov/dev/schedules/google_transit_Fall_2021.zip  

同様に、GTFS Schedule ファイルを含む ZIP フォルダの名前も、フィード自体を更新した場合でも一貫して維持してください。例えば、フィードを更新する際に ZIP フォルダ名に日付やバージョン番号を追加してはいけません。フィードのバージョンや開始日・終了日に関する情報を含めたい場合は、feed_info.txt ファイルに記載することができます。

- **良い例:** “YourAgency_gtfs.zip”, “google_transit.zip”, “gtfs.zip”  
- **避けるべき例:** “YourAgency_gtfs_092921.zip”, “YourAgency_Fall2021.zip”  

### ファイル構成と整合性 {: #file-configuration-and-integrity}

GTFS は、複数の相互に関連するテキストファイル (.txt) を含む zip ファイルです。フォーマットが正しいことを保証するために、常に以下を行ってください。

1. テキストファイルを開くときは、値をテキストとして保持するようにしてください。GTFS には、Excel などのアプリケーションが誤って読み取ったり、省略したりするフィールドが多数存在します。
2. ファイルはタブ区切りではなく、カンマ区切りです。つまり、各ファイルは行ごとにレコードを含み、異なるフィールドはカンマで区切られています。
3. 余分な行や列は、利用するアプリケーションでエラーを引き起こすため、ファイルを保存する際には空の行や列がないことを確認してください。
4. GTFS 内のファイルを破棄してはいけません。これらは相互に連携しており、欠落したファイルがあると利用するアプリケーションでエラーが発生する可能性があります。
5. ファイルを再度 zip 化する際は、フォルダごとではなくファイル自体を zip 化してください。正しく行えたかを確認するには、zip ファイルを解凍したときに、すぐにファイルが見える状態になっていることを確認してください。フォルダの中にさらにファイルが入っている状態ではいけません。

### 追加の考慮事項 {: #additional-considerations}

複数の事業者が同じ停留所(stop)を異なる名称やコードで共有している場合、Google Maps のようなアプリケーションはそのうちの1つを選択する必要があるかもしれません。混乱を避けるために、他の事業者と調整して名称やコードに合意することを推奨します。これにより、異なる GTFS データセット間の競合を最小限に抑えることができます。

複数の GTFS データセットが利用可能な場合があります。これは通常、Transit App のような公共向けアプリケーション用に作成されたものと、内部の運行管理 CAD/AVL システム用に作成されたものが存在することによるものです。この場合、どちらを公開用の GTFS とするかを決定する必要があります。最も乗客向けの情報を含むフィードを公開用として選択することが推奨されます。可能な限り、GTFS データセットを一致させ（停留所や便(trip)などの ID を同一にする）、内部用と公共用が競合しないようにし、さらに GTFS-RT などの他のフィードを統合できるようにすることが望ましいです。
