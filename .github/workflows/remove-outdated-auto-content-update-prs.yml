name: Remove outdated automatic content update PRs
on:
   schedule:
        - cron: "50 23 * * *"

jobs:
    fetchdata:
        runs-on: ubuntu-latest
        steps:
            - name: Load secrets from 1Password
              id: onepw_secrets
              uses: 1Password/load-secrets-action@v1.3.1
              with:
                  export-env: true # Export loaded secrets as environment variables
              env:
                  OP_SERVICE_ACCOUNT_TOKEN: ${{ secrets.OP_SERVICE_ACCOUNT_TOKEN }}
                  CREDENTIALS: "op://rbiv7rvkkrsdlpcrz3bmv7nmcu/ifkeehu5gzi7wy5ub5qvwkaire/credential"
                
            - name: Close stale issues
              uses: actions/stale@v9.0.0
              with:
                  repo-token: ${{ env.CREDENTIALS }}
                  only-labels: automated-content-update
                  days-before-close: 1
                  operations-per-run: 100
                  close-pr-message: 'This PR has been closed to prevent the same PR from piling up if no one reviews it during the day. If need be a new PR will be created at midnight.'